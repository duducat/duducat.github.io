<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>大脸猫的博客</title>
  <meta name="author" content="Joie liang">
  
  <meta name="description" content="就是博客啊，博客是什么，不知道哇">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="大脸猫的博客"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.ico" rel="icon">
  <link rel="alternate" href="/atom.xml" title="大脸猫的博客" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  

</head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">大脸猫的博客</a></h1>
  <h2><a href="/">小小老鼠小小老鼠不吃鱼，大脸猫大脸猫爱吃鱼 by duducat</a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
      <li><a href="/">Download</a></li>
    
      <li><a href="/">GitHub</a></li>
    
      <li><a href="/about">About</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div></header>
  <div id="content" class="inner">
    <aside id="sidebar" class="alignleft">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="Search">
    <input type="hidden" name="q" value="site:duducat.github.io">
  </form>
</div>

  
<div class="widget tag">
  <h3 class="title">Recent Posts</h3>
  <ul class="entry">
    
      <li>
        <a href="/2015/02/12/iostat/">iostat</a>
      </li>
    
      <li>
        <a href="/2015/01/30/lvs/">LVS</a>
      </li>
    
      <li>
        <a href="/2015/01/28/tcpcopy/">tcpcopy 压力测试</a>
      </li>
    
      <li>
        <a href="/2015/01/28/nginx-log/">nginx log 分析</a>
      </li>
    
      <li>
        <a href="/2015/01/20/ssh/">ssh</a>
      </li>
    
  </ul>
</div>


  
<div class="widget tag">
  <h3 class="title">Categories</h3>
  <ul class="entry">
  
    <li><a href="/categories/cmd/">cmd</a><small>4</small></li>
  
    <li><a href="/categories/getting-start/">getting_start</a><small>3</small></li>
  
    <li><a href="/categories/hello/">hello</a><small>2</small></li>
  
    <li><a href="/categories/install/">install</a><small>1</small></li>
  
  </ul>
</div>


  
<div class="widget tag">
  <h3 class="title">Tags</h3>
  <ul class="entry">
  
    <li><a href="/tags/cmd/">cmd</a><small>2</small></li>
  
    <li><a href="/tags/install/">install</a><small>2</small></li>
  
  </ul>
</div>

</aside>
    <div id="main-col" class="alignright"><div id="wrapper">
  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2015-02-12T09:04:15.000Z"><a href="/2015/02/12/iostat/">Feb 12 2015</a></time>
      
      
  
    <h1 class="title"><a href="/2015/02/12/iostat/">iostat</a></h1>
  

    </header>
    <div class="entry">
      
        <p>ostat<br>Linux系统中的 iostat是I/O statistics（输入/输出统计）的缩写，iostat工具将对系统的磁盘操作活动进行监视。它的特点是汇报磁盘活动统计情况，同时也会汇报出CPU使用情况。同vmstat一样，iostat也有一个弱点，就是它不能对某个进程进行深入分析，仅对系统的整体情况进行分析。iostat属于sysstat软件包。可以用yum install sysstat 直接安装。</p>
<ol>
<li><p>命令格式：<br>iostat[参数][时间][次数]</p>
</li>
<li><p>命令功能：<br> 通过iostat方便查看CPU、网卡、tty设备、磁盘、CD-ROM 等等设备的活动情况,    负载信息。</p>
</li>
<li><p>命令参数：</p>
</li>
</ol>
<figure class="highlight"><pre><div class="line">-<span class="ruby"><span class="constant">C</span> 显示<span class="constant">CPU</span>使用情况</span></div><div class="line">-<span class="ruby">d 显示磁盘使用情况</span></div><div class="line">-<span class="ruby">k 以 <span class="constant">KB</span> 为单位显示</span></div><div class="line">-<span class="ruby">m 以 <span class="constant">M</span> 为单位显示</span></div><div class="line">-<span class="ruby"><span class="constant">N</span> 显示磁盘阵列(<span class="constant">LVM</span>) 信息</span></div><div class="line">-<span class="ruby">n 显示<span class="constant">NFS</span> 使用情况</span></div><div class="line">-<span class="ruby">p[磁盘] 显示磁盘和分区的情况</span></div><div class="line">-<span class="ruby">t 显示终端和<span class="constant">CPU</span>的信息</span></div><div class="line">-<span class="ruby">x 显示详细信息</span></div><div class="line">-<span class="ruby"><span class="constant">V</span> 显示版本信息</span></div></pre></figure>

<p>4．使用实例：</p>
<ul>
<li>(1) 显示所有设备负载情况</li>
</ul>
<figure class="highlight"><pre><div class="line"><span class="comment"># iostat</span></div><div class="line">Linux <span class="number">2.6</span>.<span class="number">39</span>-<span class="number">900.23</span>.<span class="number">1</span>.reiserfs.el5uek (localhost)   <span class="number">02</span>/<span class="number">12</span>/<span class="number">15</span></div><div class="line"></div><div class="line">avg-cpu:  <span class="variable">%user</span>   <span class="variable">%nice</span> <span class="variable">%system</span> <span class="variable">%iowait</span>  <span class="variable">%steal</span>   <span class="variable">%idle</span></div><div class="line">          <span class="number">19.16</span>    <span class="number">0</span>.<span class="number">00</span>    <span class="number">9.02</span>    <span class="number">0</span>.<span class="number">62</span>    <span class="number">0</span>.<span class="number">00</span>   <span class="number">71.19</span></div><div class="line"></div><div class="line">Device:            tps   Blk_read/<span class="keyword">s</span>   Blk_wrtn/<span class="keyword">s</span>   Blk_read   Blk_wrtn</div><div class="line">sda              <span class="number">30.42</span>       <span class="number">254.62</span>      <span class="number">1280.29</span> <span class="number">5499956022</span> <span class="number">27655224907</span></div><div class="line">sda1              <span class="number">0</span>.<span class="number">25</span>         <span class="number">0</span>.<span class="number">80</span>         <span class="number">6.07</span>   <span class="number">17310122</span>  <span class="number">131147360</span></div><div class="line">sda2              <span class="number">1.56</span>         <span class="number">0</span>.<span class="number">68</span>        <span class="number">46.04</span>   <span class="number">14648673</span>  <span class="number">994544016</span></div><div class="line">sda3              <span class="number">0</span>.<span class="number">19</span>         <span class="number">0</span>.<span class="number">71</span>         <span class="number">2.49</span>   <span class="number">15262346</span>   <span class="number">53780048</span></div><div class="line">sda4              <span class="number">0</span>.<span class="number">00</span>         <span class="number">0</span>.<span class="number">00</span>         <span class="number">0</span>.<span class="number">00</span>          <span class="number">8</span>          <span class="number">0</span></div><div class="line">sda5              <span class="number">0</span>.<span class="number">00</span>         <span class="number">0</span>.<span class="number">00</span>         <span class="number">0</span>.<span class="number">00</span>      <span class="number">27112</span>      <span class="number">60080</span></div><div class="line">sda6              <span class="number">0</span>.<span class="number">54</span>         <span class="number">0</span>.<span class="number">71</span>        <span class="number">12.75</span>   <span class="number">15420346</span>  <span class="number">275403880</span></div><div class="line">sda7              <span class="number">0</span>.<span class="number">22</span>         <span class="number">0</span>.<span class="number">00</span>         <span class="number">4.81</span>      <span class="number">57418</span>  <span class="number">103862280</span></div><div class="line">sda8             <span class="number">27.66</span>       <span class="number">251.72</span>      <span class="number">1208.13</span> <span class="number">5437228829</span> <span class="number">26096427243</span></div></pre></figure>

<p><strong>cpu属性值说明：</strong></p>
<figure class="highlight"><pre><div class="line"><span class="tag">%<span class="title">user</span></span>：CPU处在用户模式下的时间百分比。</div><div class="line"><span class="tag">%<span class="title">nice</span></span>：CPU处在带NICE值的用户模式下的时间百分比。</div><div class="line"><span class="tag">%<span class="title">system</span></span>：CPU处在系统模式下的时间百分比。</div><div class="line"><span class="tag">%<span class="title">iowait</span></span>：CPU等待输入输出完成时间的百分比。</div><div class="line"><span class="tag">%<span class="title">steal</span></span>：管理程序维护另一个虚拟处理器时，虚拟CPU的无意识等待时间百分比。</div><div class="line"><span class="tag">%<span class="title">idle</span></span>：CPU空闲时间百分比。</div></pre></figure>

<p><strong>备注：</strong>  如果%iowait的值过高，表示硬盘存在I/O瓶颈，%idle值高，表示CPU较空闲，如果%idle值高但系统响应慢时，有可能是CPU等待分配内存，此时应加大内存容量。%idle值如果持续低于10，那么系统的CPU处理能力相对较低，表明系统中最需要解决的资源是CPU。</p>
<p>disk属性值说明：</p>
<figure class="highlight"><pre><div class="line">rrqm/s:  每秒进行 merge 的读操作数目。即 rmerge/s</div><div class="line">wrqm/s:  每秒进行 merge 的写操作数目。即 wmerge/s</div><div class="line">r/s:  每秒完成的读 <span class="keyword">I</span>/<span class="keyword">O</span> 设备次数。即 rio/s</div><div class="line">w/s:  每秒完成的写 <span class="keyword">I</span>/<span class="keyword">O</span> 设备次数。即 wio/s</div><div class="line">rsec/s:  每秒读扇区数。即 rsect/s</div><div class="line">wsec/s:  每秒写扇区数。即 wsect/s</div><div class="line">rkB/s:  每秒读<span class="keyword">K</span>字节数。是 rsect/s 的一半，因为每扇区大小为<span class="number">512</span>字节。</div><div class="line">wkB/s:  每秒写<span class="keyword">K</span>字节数。是 wsect/s 的一半。</div><div class="line">avgrq-sz:  平均每次设备<span class="keyword">I</span>/<span class="keyword">O</span>操作的数据大小 (扇区)。</div><div class="line">avgqu-sz:  平均<span class="keyword">I</span>/<span class="keyword">O</span>队列长度。</div><div class="line">await:  平均每次设备<span class="keyword">I</span>/<span class="keyword">O</span>操作的等待时间 (毫秒)。</div><div class="line">svctm: 平均每次设备<span class="keyword">I</span>/<span class="keyword">O</span>操作的服务时间 (毫秒)。</div><div class="line">%util:  一秒中有百分之多少的时间用于 <span class="keyword">I</span>/<span class="keyword">O</span> 操作，即被io消耗的cpu百分比</div></pre></figure>

<p>备注：如果 %util 接近 100%，说明产生的I/O请求太多，I/O系统已经满负荷，该磁盘可能存在瓶颈。如果 svctm 比较接近 await，说明 I/O 几乎没有等待时间；如果 await 远大于 svctm，说明I/O 队列太长，io响应太慢，则需要进行必要优化。如果avgqu-sz比较大，也表示有当量io在等待。</p>
<ul>
<li>(2) 显示指定磁盘信息</li>
</ul>
<figure class="highlight"><pre><div class="line"><span class="comment"># iostat -d sda1</span></div><div class="line">Linux <span class="number">2.6</span>.<span class="number">18</span>-<span class="number">128</span>.el5 (CT1186)   <span class="number">2012</span>年<span class="number">12</span>月<span class="number">28</span>日</div><div class="line"></div><div class="line">Device:            tps   Blk_<span class="built_in">read</span>/s   Blk_wrtn/s   Blk_<span class="built_in">read</span>   Blk_wrtn</div><div class="line">sda1              <span class="number">0.00</span>         <span class="number">0.00</span>         <span class="number">0.00</span>       <span class="number">2658</span>        <span class="number">536</span></div></pre></figure>

<ul>
<li>(3) 以M为单位显示所有信息</li>
</ul>
<figure class="highlight"><pre><div class="line"><span class="comment"># iostat -m</span></div><div class="line">Linux <span class="number">2.6</span>.<span class="number">39</span>-<span class="number">900.23</span>.<span class="number">1</span>.reiserfs.el5uek (localhost) 	<span class="number">02</span>/<span class="number">12</span>/<span class="number">15</span></div><div class="line"></div><div class="line">avg-cpu:  <span class="variable">%user</span>   <span class="variable">%nice</span> <span class="variable">%system</span> <span class="variable">%iowait</span>  <span class="variable">%steal</span>   <span class="variable">%idle</span></div><div class="line">          <span class="number">19.16</span>    <span class="number">0</span>.<span class="number">00</span>    <span class="number">9.02</span>    <span class="number">0</span>.<span class="number">62</span>    <span class="number">0</span>.<span class="number">00</span>   <span class="number">71.19</span></div><div class="line"></div><div class="line">Device:            tps    MB_read/<span class="keyword">s</span>    MB_wrtn/<span class="keyword">s</span>    MB_read    MB_wrtn</div><div class="line">sda              <span class="number">30.42</span>         <span class="number">0</span>.<span class="number">12</span>         <span class="number">0</span>.<span class="number">63</span>    <span class="number">2685525</span>   <span class="number">13503568</span></div><div class="line">sda1              <span class="number">0</span>.<span class="number">25</span>         <span class="number">0</span>.<span class="number">00</span>         <span class="number">0</span>.<span class="number">00</span>       <span class="number">8452</span>      <span class="number">64039</span></div><div class="line">sda2              <span class="number">1.56</span>         <span class="number">0</span>.<span class="number">00</span>         <span class="number">0</span>.<span class="number">02</span>       <span class="number">7152</span>     <span class="number">485623</span></div><div class="line">sda3              <span class="number">0</span>.<span class="number">19</span>         <span class="number">0</span>.<span class="number">00</span>         <span class="number">0</span>.<span class="number">00</span>       <span class="number">7452</span>      <span class="number">26260</span></div><div class="line">sda4              <span class="number">0</span>.<span class="number">00</span>         <span class="number">0</span>.<span class="number">00</span>         <span class="number">0</span>.<span class="number">00</span>          <span class="number">0</span>          <span class="number">0</span></div><div class="line">sda5              <span class="number">0</span>.<span class="number">00</span>         <span class="number">0</span>.<span class="number">00</span>         <span class="number">0</span>.<span class="number">00</span>         <span class="number">13</span>         <span class="number">29</span></div><div class="line">sda6              <span class="number">0</span>.<span class="number">54</span>         <span class="number">0</span>.<span class="number">00</span>         <span class="number">0</span>.<span class="number">01</span>       <span class="number">7529</span>     <span class="number">134475</span></div><div class="line">sda7              <span class="number">0</span>.<span class="number">22</span>         <span class="number">0</span>.<span class="number">00</span>         <span class="number">0</span>.<span class="number">00</span>         <span class="number">28</span>      <span class="number">50714</span></div><div class="line">sda8             <span class="number">27.66</span>         <span class="number">0</span>.<span class="number">12</span>         <span class="number">0</span>.<span class="number">59</span>    <span class="number">2654896</span>   <span class="number">12742425</span></div></pre></figure>

<ul>
<li>(4) 查看TPS和吞吐量信息</li>
</ul>
<figure class="highlight"><pre><div class="line"><span class="comment"># iostat -d -k 1 1</span></div><div class="line">Linux <span class="number">2.6</span>.<span class="number">39</span>-<span class="number">900.23</span>.<span class="number">1</span>.reiserfs.el5uek (localhost) 	<span class="number">02</span>/<span class="number">12</span>/<span class="number">15</span></div><div class="line"></div><div class="line">Device:            tps    kB_<span class="built_in">read</span>/s    kB_wrtn/s    kB_<span class="built_in">read</span>    kB_wrtn</div><div class="line">sda              <span class="number">30.42</span>       <span class="number">127.31</span>       <span class="number">640.13</span> <span class="number">2749978019</span> <span class="number">13827662279</span></div><div class="line">sda1              <span class="number">0.25</span>         <span class="number">0.40</span>         <span class="number">3.04</span>    <span class="number">8655061</span>   <span class="number">65577024</span></div><div class="line">sda2              <span class="number">1.56</span>         <span class="number">0.34</span>        <span class="number">23.02</span>    <span class="number">7324344</span>  <span class="number">497279856</span></div><div class="line">sda3              <span class="number">0.19</span>         <span class="number">0.35</span>         <span class="number">1.24</span>    <span class="number">7631173</span>   <span class="number">26890684</span></div><div class="line">sda4              <span class="number">0.00</span>         <span class="number">0.00</span>         <span class="number">0.00</span>          <span class="number">4</span>          <span class="number">0</span></div><div class="line">sda5              <span class="number">0.00</span>         <span class="number">0.00</span>         <span class="number">0.00</span>      <span class="number">13556</span>      <span class="number">30040</span></div><div class="line">sda6              <span class="number">0.54</span>         <span class="number">0.36</span>         <span class="number">6.37</span>    <span class="number">7710173</span>  <span class="number">137702820</span></div><div class="line">sda7              <span class="number">0.22</span>         <span class="number">0.00</span>         <span class="number">2.40</span>      <span class="number">28709</span>   <span class="number">51932084</span></div><div class="line">sda8             <span class="number">27.66</span>       <span class="number">125.85</span>       <span class="number">604.05</span> <span class="number">2718614414</span> <span class="number">13048249771</span></div></pre></figure>

<p>说明：</p>
<figure class="highlight"><pre><div class="line">tps：该设备每秒的传输次数（Indicate <span class="operator">the</span> <span class="built_in">number</span> <span class="operator">of</span> transfers per <span class="keyword">second</span> that were issued <span class="built_in">to</span> <span class="operator">the</span> device.）。“一次传输”意思是“一次I/O请求”。多个逻辑请求可能会被合并为“一次I/O请求”。“一次传输”请求的大小是未知的。</div><div class="line">kB_read/s：每秒从设备（drive expressed）读取的数据量；</div><div class="line">kB_wrtn/s：每秒向设备（drive expressed）写入的数据量；</div><div class="line">kB_read：读取的总数据量；kB_wrtn：写入的总数量数据量；</div><div class="line">这些单位都为Kilobytes。</div></pre></figure>

<p>上面的例子中，我们可以看到磁盘sda以及它的各个分区的统计数据，当时统计的磁盘总TPS是22.73，下面是各个分区的TPS。（因为是瞬间值，所以总TPS并不严格等于各个分区TPS的总和）</p>
<ul>
<li>(5)查看设备使用率（%util）、响应时间（await）</li>
</ul>
<figure class="highlight"><pre><div class="line"># iostat -d -x -k <span class="number">1</span> <span class="number">1</span></div><div class="line">Linux <span class="number">2.6</span>.<span class="number">39</span>-<span class="number">900.23</span>.<span class="number">1</span>.reiserfs.el5uek (localhost) 	<span class="number">02</span><span class="regexp">/12/</span><span class="number">15</span></div><div class="line"></div><div class="line">Device:         rrqm<span class="regexp">/s   wrqm/</span>s   r<span class="regexp">/s   w/</span>s    rkB<span class="regexp">/s    wkB/</span>s avgrq-sz avgqu-sz   await  svctm  %util</div><div class="line">sda               <span class="number">0.00</span>     <span class="number">6.52</span>  <span class="number">7.49</span> <span class="number">22.93</span>   <span class="number">127.31</span>   <span class="number">640.13</span>    <span class="number">50.45</span>     <span class="number">0.13</span>    <span class="number">4.32</span>   <span class="number">1.70</span>   <span class="number">5.17</span></div><div class="line">sda1              <span class="number">0.00</span>     <span class="number">0.52</span>  <span class="number">0.01</span>  <span class="number">0.24</span>     <span class="number">0.40</span>     <span class="number">3.04</span>    <span class="number">27.13</span>     <span class="number">0.00</span>    <span class="number">0.54</span>   <span class="number">0.32</span>   <span class="number">0.01</span></div><div class="line">sda2              <span class="number">0.00</span>     <span class="number">4.22</span>  <span class="number">0.03</span>  <span class="number">1.53</span>     <span class="number">0.34</span>    <span class="number">23.02</span>    <span class="number">30.01</span>     <span class="number">0.00</span>    <span class="number">0.61</span>   <span class="number">0.21</span>   <span class="number">0.03</span></div><div class="line">sda3              <span class="number">0.00</span>     <span class="number">0.17</span>  <span class="number">0.05</span>  <span class="number">0.14</span>     <span class="number">0.35</span>     <span class="number">1.24</span>    <span class="number">16.87</span>     <span class="number">0.00</span>    <span class="number">0.89</span>   <span class="number">0.55</span>   <span class="number">0.01</span></div><div class="line">sda4              <span class="number">0.00</span>     <span class="number">0.00</span>  <span class="number">0.00</span>  <span class="number">0.00</span>     <span class="number">0.00</span>     <span class="number">0.00</span>     <span class="number">2.00</span>     <span class="number">0.00</span>    <span class="number">4.00</span>   <span class="number">4.00</span>   <span class="number">0.00</span></div><div class="line">sda5              <span class="number">0.00</span>     <span class="number">0.00</span>  <span class="number">0.00</span>  <span class="number">0.00</span>     <span class="number">0.00</span>     <span class="number">0.00</span>     <span class="number">8.53</span>     <span class="number">0.00</span>    <span class="number">0.98</span>   <span class="number">0.13</span>   <span class="number">0.00</span></div><div class="line">sda6              <span class="number">0.00</span>     <span class="number">1.10</span>  <span class="number">0.05</span>  <span class="number">0.49</span>     <span class="number">0.36</span>     <span class="number">6.37</span>    <span class="number">24.89</span>     <span class="number">0.00</span>    <span class="number">0.54</span>   <span class="number">0.21</span>   <span class="number">0.01</span></div><div class="line">sda7              <span class="number">0.00</span>     <span class="number">0.38</span>  <span class="number">0.00</span>  <span class="number">0.22</span>     <span class="number">0.00</span>     <span class="number">2.40</span>    <span class="number">21.71</span>     <span class="number">0.00</span>    <span class="number">0.64</span>   <span class="number">0.17</span>   <span class="number">0.00</span></div><div class="line">sda8              <span class="number">0.00</span>     <span class="number">0.13</span>  <span class="number">7.35</span> <span class="number">20.31</span>   <span class="number">125.85</span>   <span class="number">604.05</span>    <span class="number">52.78</span>     <span class="number">0.13</span>    <span class="number">4.69</span>   <span class="number">1.85</span>   <span class="number">5.12</span></div></pre></figure>

<p>说明：</p>
<figure class="highlight"><pre><div class="line">rrqm/s：  每秒进行 merge 的读操作数目.即 delta(rmerge)/s</div><div class="line">wrqm/s： 每秒进行 merge 的写操作数目.即 delta(wmerge)/s</div><div class="line">r/s：  每秒完成的读 <span class="keyword">I</span>/<span class="keyword">O</span> 设备次数.即 delta(rio)/s</div><div class="line">w/s：  每秒完成的写 <span class="keyword">I</span>/<span class="keyword">O</span> 设备次数.即 delta(wio)/s</div><div class="line">rsec/s：  每秒读扇区数.即 delta(rsect)/s</div><div class="line">wsec/s： 每秒写扇区数.即 delta(wsect)/s</div><div class="line">rkB/s：  每秒读<span class="keyword">K</span>字节数.是 rsect/s 的一半,因为每扇区大小为<span class="number">512</span>字节.(需要计算)</div><div class="line">wkB/s：  每秒写<span class="keyword">K</span>字节数.是 wsect/s 的一半.(需要计算)</div><div class="line">avgrq-sz：平均每次设备<span class="keyword">I</span>/<span class="keyword">O</span>操作的数据大小 (扇区).delta(rsect+wsect)/delta(rio+wio)</div><div class="line">avgqu-sz：平均<span class="keyword">I</span>/<span class="keyword">O</span>队列长度.即 delta(aveq)/s/<span class="number">1000</span> (因为aveq的单位为毫秒).</div><div class="line">await：  平均每次设备<span class="keyword">I</span>/<span class="keyword">O</span>操作的等待时间 (毫秒).即 delta(ruse+wuse)/delta(rio+wio)</div><div class="line">svctm： 平均每次设备<span class="keyword">I</span>/<span class="keyword">O</span>操作的服务时间 (毫秒).即 delta(use)/delta(rio+wio)</div><div class="line">%util： 一秒中有百分之多少的时间用于 <span class="keyword">I</span>/<span class="keyword">O</span> 操作,或者说一秒中有多少时间 <span class="keyword">I</span>/<span class="keyword">O</span> 队列是非空的，即 delta(use)/s/<span class="number">1000</span> (因为use的单位为毫秒)</div></pre></figure>

<ul>
<li><p>如果 %util 接近 100%，说明产生的I/O请求太多，I/O系统已经满负荷，该磁盘可能存在瓶颈。</p>
</li>
<li><p>idle小于70% IO压力就较大了，一般读取速度有较多的wait。<br>同时可以结合vmstat 查看查看b参数(等待资源的进程数)和wa参数(IO等待所占用的CPU时间的百分比，高过30%时IO压力高)。</p>
</li>
</ul>
<p>另外 await 的参数也要多和 svctm 来参考。差的过高就一定有 IO 的问题。</p>
<ul>
<li>avgqu-sz 也是个做 IO 调优时需要注意的地方，这个就是直接每次操作的数据的大小，如果次数多，但数据拿的小的话，其实 IO 也会很小。如果数据拿的大，才IO 的数据会高。也可以通过 avgqu-sz × ( r/s or w/s ) = rsec/s or wsec/s。也就是讲，读定速度是这个来决定的。</li>
<li>svctm 一般要小于 await (因为同时等待的请求的等待时间被重复计算了)，svctm 的大小一般和磁盘性能有关，CPU/内存的负荷也会对其有影响，请求过多也会间接导致 svctm 的增加。await 的大小一般取决于服务时间(svctm) 以及 I/O 队列的长度和 I/O 请求的发出模式。如果 svctm 比较接近 await，说明 I/O 几乎没有等待时间；</li>
<li>如果 await 远大于 svctm，说明 I/O 队列太长，应用得到的响应时间变慢，如果响应时间超过了用户可以容许的范围，这时可以考虑更换更快的磁盘，调整内核 elevator 算法，优化应用，或者升级 CPU。</li>
<li>队列长度(avgqu-sz)也可作为衡量系统 I/O 负荷的指标，但由于 avgqu-sz 是按照单位时间的平均值，所以不能反映瞬间的 I/O 洪水。</li>
</ul>
<p><strong>形象的比喻：</strong></p>
<ul>
<li>r/s+w/s 类似于交款人的总数</li>
<li>平均队列长度(avgqu-sz)类似于单位时间里平均排队人的个数</li>
<li>平均服务时间(svctm)类似于收银员的收款速度</li>
<li>平均等待时间(await)类似于平均每人的等待时间</li>
<li>平均I/O数据(avgrq-sz)类似于平均每人所买的东西多少</li>
<li>I/O操作率 (%util)类似于收款台前有人排队的时间比例</li>
</ul>
<p>设备IO操作: 总IO(io)/s = r/s(读) +w/s(写) =1.46 + 25.28=26.74</p>
<p>平均每次设备I/O操作只需要0.36毫秒完成,现在却需要10.57毫秒完成，因为发出的请求太多(每秒26.74个)，假如请求时同时发出的，可以这样计算平均等待时间:</p>
<p>平均等待时间=单个I/O服务器时间*(1+2+…+请求总数-1)/请求总数</p>
<p>每秒发出的I/0请求很多,但是平均队列就4,表示这些请求比较均匀,大部分处理还是比较及时。</p>
<p>参考文档：<a href="http://www.cnblogs.com/peida/archive/2012/12/28/2837345.html" target="_blank" rel="external">戳我</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>

<% if (page.comments){ %>
<section id="comment">
  <h1 class="title"><%= __('comment') %></h1>

  <% if(config.disqus_shortname) { %>
  <div id="disqus_thread">
    <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    <% var disqus_shortname = 'duducat'; %>// required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
    </script>

    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
  <% } %>
</section>
<% } %>





        <nav id="pagination">
  
  
    <a href="/page/2/" class="alignright next">Next</a>
  
  <div class="clearfix"></div>
</nav> 

</div></div>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2015 Joie liang
  
</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>


<script type="text/javascript">
var disqus_shortname = 'duducat';

(function(){
  var dsq = document.createElement('script');
  dsq.type = 'text/javascript';
  dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
}());
</script>



<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

</body>
</html>
